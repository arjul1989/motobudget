{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/jules/Moto_Budget/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = globalThis as unknown as { prisma: PrismaClient };\n\nexport const prisma = globalForPrisma.prisma || new PrismaClient();\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\n\nexport default prisma;\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,sMAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD"}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":["file:///Users/jules/Moto_Budget/lib/auth.ts"],"sourcesContent":["import { NextAuthOptions } from \"next-auth\"\nimport GoogleProvider from \"next-auth/providers/google\"\nimport { PrismaAdapter } from \"@auth/prisma-adapter\"\nimport prisma from \"@/lib/prisma\"\n\nexport const authOptions: NextAuthOptions = {\n    adapter: PrismaAdapter(prisma),\n    providers: [\n        GoogleProvider({\n            clientId: process.env.GOOGLE_CLIENT_ID || \"\",\n            clientSecret: process.env.GOOGLE_CLIENT_SECRET || \"\",\n        }),\n    ],\n    callbacks: {\n        session: async ({ session, user }) => {\n            if (session?.user) {\n                session.user.id = user.id;\n            }\n            return session;\n        },\n    },\n    debug: true,\n}\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;;;;AAEO,MAAM,cAA+B;IACxC,SAAS,IAAA,uKAAa,EAAC,0HAAM;IAC7B,WAAW;QACP,IAAA,gKAAc,EAAC;YACX,UAAU,QAAQ,GAAG,CAAC,gBAAgB,IAAI;YAC1C,cAAc,QAAQ,GAAG,CAAC,oBAAoB,IAAI;QACtD;KACH;IACD,WAAW;QACP,SAAS,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE;YAC7B,IAAI,SAAS,MAAM;gBACf,QAAQ,IAAI,CAAC,EAAE,GAAG,KAAK,EAAE;YAC7B;YACA,OAAO;QACX;IACJ;IACA,OAAO;AACX"}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["file:///Users/jules/Moto_Budget/app/api/motos/%5Bid%5D/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport prisma from \"@/lib/prisma\";\nimport { getServerSession } from \"next-auth\";\nimport { authOptions } from \"@/lib/auth\";\n\n// GET: Fetch single moto\nexport async function GET(\n    request: NextRequest,\n    { params }: { params: Promise<{ id: string }> }\n) {\n    const session = await getServerSession(authOptions);\n    if (!session?.user?.email) {\n        return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n    }\n\n    const { id } = await params;\n\n    try {\n        const moto = await prisma.moto.findUnique({\n            where: { id },\n            include: { spareParts: true },\n        });\n\n        if (!moto) {\n            return NextResponse.json({ error: \"Moto not found\" }, { status: 404 });\n        }\n\n        if (moto.userId !== session.user.id) {\n            return NextResponse.json({ error: \"Unauthorized access\" }, { status: 403 });\n        }\n\n        return NextResponse.json(moto);\n    } catch (error) {\n        return NextResponse.json({ error: \"Error fetching moto\" }, { status: 500 });\n    }\n}\n\n// PUT: Update moto details\nexport async function PUT(\n    request: NextRequest,\n    { params }: { params: Promise<{ id: string }> }\n) {\n    const session = await getServerSession(authOptions);\n    if (!session?.user?.email) {\n        return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n    }\n\n    const { id } = await params;\n    const body = await request.json();\n\n    try {\n        // Basic verification\n        const existing = await prisma.moto.findUnique({ where: { id } });\n        if (!existing || existing.userId !== session.user.id) {\n            return NextResponse.json({ error: \"Unauthorized or not found\" }, { status: 403 });\n        }\n\n        // Update Moto fields\n        await prisma.moto.update({\n            where: { id },\n            data: {\n                purchaseCostReal: body.purchaseCostReal,\n                paperworkCostReal: body.paperworkCostReal,\n                laborCostReal: body.laborCostReal,\n                salePriceEstimated: body.salePriceEstimated,\n                image: body.image,\n                plate: body.plate,\n                status: body.status\n            }\n        });\n\n        // Handle Parts: Create new ones or update?\n        // For simplicity, if 'parts' is provided, we can upsert.\n        if (body.parts && Array.isArray(body.parts)) {\n            for (const part of body.parts) {\n                if (part.id) {\n                    // Update existing\n                    await prisma.sparePart.update({\n                        where: { id: part.id },\n                        data: { costReal: part.real, costEstimated: part.estimated, name: part.name }\n                        // Note: ensure mapping matches UI\n                    }).catch(() => { }); // Ignore if not found\n                } else {\n                    // Create new\n                    await prisma.sparePart.create({\n                        data: {\n                            motoId: id,\n                            name: part.name,\n                            costEstimated: part.estimated,\n                            costReal: part.real || 0\n                        }\n                    });\n                }\n            }\n        }\n\n        return NextResponse.json({ success: true });\n    } catch (error) {\n        console.error(\"Error updating moto:\", error);\n        return NextResponse.json({ error: \"Error updating moto\" }, { status: 500 });\n    }\n}\n\n// DELETE: Remove moto\nexport async function DELETE(\n    request: NextRequest,\n    { params }: { params: Promise<{ id: string }> }\n) {\n    const session = await getServerSession(authOptions);\n    if (!session?.user?.email) {\n        return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\n    }\n\n    const { id } = await params;\n\n    try {\n        const existing = await prisma.moto.findUnique({ where: { id } });\n        if (!existing || existing.userId !== session.user.id) {\n            return NextResponse.json({ error: \"Unauthorized or not found\" }, { status: 403 });\n        }\n\n        await prisma.moto.delete({ where: { id } });\n\n        return NextResponse.json({ success: true });\n    } catch (error) {\n        console.error(\"Error deleting moto:\", error);\n        return NextResponse.json({ error: \"Error deleting moto\" }, { status: 500 });\n    }\n}\n"],"names":[],"mappings":"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"}}]
}